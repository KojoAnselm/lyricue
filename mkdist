#!/bin/bash
if [ "$1" = "release" ] 
then echo Making release
CHANGELOG="debian/changelog-release"
cat debian/rules-base | sed -e 's/lyricue-cvs/lyricue/g' > debian/rules
chmod +x debian/rules
cat debian/menu-base | sed -e 's/lyricue-cvs/lyricue/g' > debian/menu
else CHANGELOG="debian/changelog-cvs"
cp debian/rules-base debian/rules
cp debian/menu-base debian/menu
fi

for DIST in intrepid jaunty karmic lucid
do echo Building for ${DIST}
if [ "$1" = "release" ]
then cat debian/control-${DIST} | sed -e 's/lyricue-cvs/lyricue/g' > debian/control
else cp debian/control-${DIST} debian/control
fi
cat ${CHANGELOG} | head -1 | sed -e "s/karmic/$DIST/g" -e "s/)/${DIST})/g"  > debian/changelog
echo "  * Build for ${DIST}" >> debian/changelog
echo "" >> debian/changelog
echo " -- Chris Debenham <chris@adebenham.com> " `date -R` >> debian/changelog
echo "" >> debian/changelog
cat $CHANGELOG >> debian/changelog
debuild -S -sa -kB734D1F5
done

#(cd ..;dput ppa:chris-debenham/lyricue lyricue-*_source.changes)
rm debian/rules debian/changelog debian/control debian/menu
